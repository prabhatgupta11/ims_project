<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Tax Master</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="../../vendors/feather/feather.css">
    <link rel="stylesheet" href="../../vendors/ti-icons/css/themify-icons.css">
    <link rel="stylesheet" href="../../vendors/css/vendor.bundle.base.css">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <link rel="stylesheet" href="../../vendors/select2/select2.min.css">
    <link rel="stylesheet" href="../../vendors/select2-bootstrap-theme/select2-bootstrap.min.css">
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="../../css/vertical-layout-light/style.css">
    <!-- endinject -->
    <link rel="shortcut icon" href="../../images/favicon.png" />
    <style>
        .color-container {
            position: absolute;
            z-index: 0;
            top: 0;
            height: 200px;
            width: 100%;
            background-color: #9096de;
        }
    </style>
</head>

<body>
    <div class="container-scroller">
        <!-- partial:../../partials/_navbar.html -->
        {{>navbar}}
        <!-- partial -->
        <div class="container-fluid page-body-wrapper">
            <!-- partial:../../partials/_settings-panel.html -->
            {{>setting}}
            <!-- partial -->
            <!-- partial:../../partials/_sidebar.html -->
            {{>side}}
            <!-- partial -->

            <div class="main-panel">
                <div class="color-container"></div>
                <div class="content-wrapper">

                    <div class="row">
                        <div class="d-flex mt-2 mb-3">
                            <a href="/taxMasterList" class="text-white" style="z-index: 3;"><i
                                    class="fa-solid fa-angle-left "></i></a>
                            <h3 class="card-title ml-4 my-0 font-weight-semibold text-white" style="z-index: 3;">Tax
                                Master</h3>


                        </div>
                        {{#if message}}
                        <div class="alert alert-info">{{message}}</div>
                        {{/if}}
                        <div id="flash-message" class="alert alert-danger" style="display: none;"></div>
                        <form id="taxMasterform" action="/createTaxMaster" method="post">
                            <div class="row">
                                <div class="col-md-6 grid-margin stretch-card">
                                    <div class="card col-md-11 wrapper">
                                        <div class="card-body p-0">
                                            <div class="row justify-content-around mx-auto ">
                                                <div class="col-md-12">
                                                    <div class="form-group mb-2 ">
                                                        <label for="Code" class="label-block">Tax Code</label>
                                                        <input class="form-control input-field" type="text"
                                                            id="Tax_Code" name="Tax_Code" class="sup-int"
                                                            placeholder="Enter Tax Code" required />
                                                        <div class="sup-icon">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group mb-2 ">
                                                        <label for="Name" class="label-block">HSN Code<span
                                                                class="text-danger">*</span>:</label>
                                                        <input class="form-control input-field" type="text"
                                                            id="HSN_Code" name="HSN_Code"
                                                            placeholder=" Enter HSN Code" />
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group mb-2 ">
                                                        <label for="State_Code" class="label-block">State <span
                                                                class="text-danger">*</span></label>

                                                        <select class="form-control input-field" id="State_Code"
                                                            name="State_Code" required>

                                                        </select>

                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group mb-2 ">
                                                        <label for="Display_order">Tax percentage </label>
                                                        <input class="form-control input-field" type="number"
                                                            id="Tax_percentage" name="Tax_percentage"
                                                            placeholder="Enter Tax percentage" required />
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group mb-2 ">
                                                        <label for="Status" class="label-block">Status:</label>
                                                        <select class="form-control input-field" id="Status"
                                                            name="Status">
                                                            <option value="Active" selected>Active</option>
                                                            <option value="Inactive">Inactive</option>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="col-md-12">
                                                    <div class="form-group mb-2 ">
                                                        <label for="Description">Description</label>
                                                        <textarea class="form-control input-field" id="Description"
                                                            name="Description" rows="4" placeholder="Enter Description"
                                                            cols="72" style="width: 100%;"></textarea>
                                                    </div>
                                                </div>

                                               <div class="inner-cont p-0 col-md-11 col-lg-11 flex-column  flex-wrap col-12 d-flex  justify-content-between align-content-start">
                         <div class="d-flex align-items-center justify-content-start my-2  col-md-12 p-0" >
                         <button class="btn btn-primary mr-2 " role="button" type="submit" style="padding: 9px 20px;
    border-radius: 6px;">Save</button>
                    <button class="btn btn-light" role="button" type="reset" style=" padding: 9px 20px;
    border-radius: 6px;">Reset</button>
    </div>
                        </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- container-scroller -->
    <!-- plugins:js -->
    <script src="../../vendors/js/vendor.bundle.base.js"></script>
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <script src="../../vendors/typeahead.js/typeahead.bundle.min.js"></script>
    <script src="../../vendors/select2/select2.min.js"></script>
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="../../js/off-canvas.js"></script>
    <script src="../../js/hoverable-collapse.js"></script>
    <script src="../../js/template.js"></script>
    <script src="../../js/settings.js"></script>
    <script src="../../js/todolist.js"></script>
    <!-- endinject -->
    <!-- Custom js for this page-->
    <script src="../../js/file-upload.js"></script>
    <script src="../../js/typeahead.js"></script>
    <script src="../../js/select2.js"></script>
    <!-- End custom js for this page-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</body>

</html>

<script>
   $.get(`/taxxMasterCode`, function (reffnum) {
    function generateUniqueIdentifier(response) {
      if (response && response.length === 1) {
        const item = response[0];
        const { id, prefix, lastNo, suffix } = item;
        
        // Increment the lastno value and pad it to 6 digits
        const newLastNo = (parseInt(lastNo) + 1).toString().padStart(6, '0');
        
        // Construct the unique identifier string
        const uniqueIdentifier = `${prefix}/${newLastNo}/${suffix}`;
        
        // Update the lastno value in the response
        item.lastNo = newLastNo;
         // Update the input field value with the uniqueIdentifier
        $('#Tax_Code').val(uniqueIdentifier);
        
        
        return uniqueIdentifier;
      } else {
        return null; // Handle invalid response
      }
    }

    const uniqueIdentifier = generateUniqueIdentifier(reffnum);
    console.log('Generated Unique Identifier:', uniqueIdentifier);
   });
</script>
<script>


    document.addEventListener("DOMContentLoaded", function () {
        const stateSelect = document.getElementById("State_Code");


        stateSelect.innerHTML = '<option value="">Select State</option>';


        fetch("/allState")
            .then((res) => {
                return res.json();
            })

            .then((data) => {


                data.forEach((ele) => {
                    const option = document.createElement("option");
                    option.value = ele.id;
                    option.textContent = ele.Name;
                    stateSelect.appendChild(option);
                })


            })
            .then((err) => {
                console.log(err)
            })

    });

   // document.getElementById("taxMasterform").addEventListener("submit", function () {
 


        // Collect form data
     /*   const formData = {
            Tax_Code: document.getElementById("Tax_Code").value,
            HSN_Code: document.getElementById("HSN_Code").value,
            Tax_percentage: document.getElementById("Tax_percentage").value,
            Description: document.getElementById("Description").value,
            Status: document.getElementById("Status").value,
            State_Code: document.getElementById("State_Code").value,
        };

        console.log(55555, formData)



        fetch('/createTaxMaster', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData),
        })
            .then(response => response.json())
            .then(data => {
                console.log('Data sent:', data);


            })
            .catch(error => {
                console.error('Error:', error);
            });



    });  */


</script>