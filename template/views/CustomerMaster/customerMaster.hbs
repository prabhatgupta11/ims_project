<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Add Customer</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="../../vendors/feather/feather.css">
  <link rel="stylesheet" href="../../vendors/ti-icons/css/themify-icons.css">
  <link rel="stylesheet" href="../../vendors/css/vendor.bundle.base.css">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <link rel="stylesheet" href="../../vendors/select2/select2.min.css">
  <link rel="stylesheet" href="../../vendors/select2-bootstrap-theme/select2-bootstrap.min.css">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="../../css/vertical-layout-light/style.css">
  <!-- endinject -->
  <link rel="shortcut icon" href="../../images/favicon.png" />
  <style>
    .color-container {
      position: absolute;
      z-index: 0;
      top: 0;
      height: 200px;
      width: 100%;
      background-color: #9096de;
    }
  </style>
</head>

<body>
  <div class="container-scroller">
    <!-- partial:../../partials/_navbar.html -->
    {{>navbar}}
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <!-- partial:../../partials/_settings-panel.html -->
      {{>setting}}
      <!-- partial -->
      <!-- partial:../../partials/_sidebar.html -->
      {{>side}}
      <!-- partial -->

      <div class="main-panel">
        <div class="color-container"></div>
        <div class="content-wrapper">

          <div class="row">
            <div class="d-flex mt-2 mb-3">
              <a href="/customerMasterList" class="text-white" style="z-index: 3;"><i
                  class="fa-solid fa-angle-left "></i></a>
              <h3 class="card-title ml-4 my-0 font-weight-semibold text-white" style="z-index: 3;">Add Customer Master</h3>


            </div>
            {{#if message}}
            <div class="alert alert-info">{{message}}</div>
            {{/if}}
            <div id="flash-message" class="alert alert-danger" style="display: none;"></div>
            <form id="supplierForm" action="/createCustomerMaster" method="post">
              <div class="row justify-content-around">
                <div class="col-md-6 grid-margin stretch-card ">
                  <div class="card col-md-11 wrapper">
                    <div class="card-body p-0">
                      <div class="row justify-content-around mx-auto ">
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="exampleFormControlTextarea1" class="mt-2 mr-3">Name<span
                                class="text-danger">*</span></label>
                            <input class="form-control input-field" type="text" id="Name" name="Name"
                              placeholder=" Enter Name" required oninput=AlphabateValidate(this)
                              title="Please enter only letters">
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="exampleFormControlTextarea1" class="mt-2 mr-3">Contact Person Name</label>
                            <input class="form-control input-field" type="text" id="ContactPersonName"
                              name="ContactPersonName" oninput=validateContactPersonName(this)
                              placeholder=" Enter Contact Person" title="Please enter only letters">
                          </div>
                        </div>
                      </div>
                      <div class="row justify-content-around mx-auto ">
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="ContactNo1">Contact No. 1 <span class="text-danger">*</span> </label>
                            <input class="form-control input-field" type="number" id="ContactNo1" name="ContactNo1"
                              placeholder="&#x260E; Enter Contact Number 1" required maxlength="10"
                              oninput=contactNoValidate(this) title="Please enter a 10-digit phone number">
                          </div>
                          <div class="form-group mb-2 ">
                            <label for="ContactNo2">Contact No. 2</label>
                            <input class="form-control input-field" type="number" id="ContactNo2" name="ContactNo2"
                              placeholder="&#x260E; Enter Contact Number 2" maxlength="10"
                              oninput=contactNoValidate(this) title="Please enter a 10-digit phone number">
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Email">Email <span class="text-danger">*</span> :</label>
                            <input class="form-control input-field" type="email" id="Email" name="Email"
                              oninput=emailValidate(this) placeholder="&#x2709;  Enter Email" required />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="AadharNo">Aadhar No</label>
                            <input class="form-control input-field" type="number" id="AadharNo" name="AadharNo"
                              placeholder="&#9751;  Enter Aadhar Number" oninput=aadharNumberValidate(this)
                              title="Please enter a 12-digit Aadhar Number">
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">

                            <label for="PAN">PAN <span class="text-danger">*</span></label>
                            <input class="form-control input-field" type="text" id="PAN" name="PAN"
                              placeholder=" Enter PAN" oninput=panNoValidate(this) minlength="10"
                              maxlength="10" title="Please enter a 10-digit PAN Number" />
                          </div>
                        </div>

                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 grid-margin stretch-card ">
                  <div class="card col-md-11 wrapper">
                    <div class="card-body p-0">
                      <div class="row justify-content-around mx-auto col-md-12 ">
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Code" class="label-block">Code</label>
                            <input class="form-control input-field" type="text" id="Code" name="Code" class="sup-int" placeholder="Enter Customer Code"
                              readonly />
                            <div class="sup-icon">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Pincode">Pincode</label>
                            <input class="form-control input-field" type="number" id="Pincode" name="Pincode"
                              oninput=pinCodeValidate(this) placeholder="  Enter Pincode" maxlength="6"
                              title="Please enter a 6-digit Pin Code Number" />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="GSTNo">GST No <span class="text-danger">*</span></label>
                            <input class="form-control input-field" type="text" id="GSTNo" name="GSTNo"
                              placeholder=" Enter GST No." oninput="gstNoValidate(this)" minlength="15" maxlength="15"
                              title="Please enter a 15-digit GST Number" required />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Status" class="label-block">Status:</label>
                            <select class="form-control input-field" id="Status" name="Status">
                              <option value="Active" selected>Active</option>
                              <option value="Inactive">Inactive</option>
                            </select>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Address">Address <span class="text-danger">*</span></label>
                            <div>
                              <textarea class="form-control input-field" id="Address" name="Address" rows="4"
                                placeholder="Enter Address" cols="72" oninput=AddressValidate(this) style="width: 100%;"
                                required></textarea><br><br>
                            </div>
                          </div>
                        </div>
                         <div class="inner-cont p-0 col-md-11 col-lg-11 flex-column  flex-wrap col-12 d-flex  justify-content-between align-content-start">
                         <div class="d-flex align-items-center justify-content-start my-2  col-md-12 p-0" >
                         <button class="btn btn-primary mr-2 " role="button" type="submit" style="padding: 9px 20px;
    border-radius: 6px;">Save</button>
                    <button class="btn btn-light" role="button" type="reset" style=" padding: 9px 20px;
    border-radius: 6px;">Reset</button>
    </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>


            </form>
          </div>

        </div>


      </div>
    </div>
  </div>
  <!-- container-scroller -->
  <!-- plugins:js -->
  <script src="../../vendors/js/vendor.bundle.base.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script src="../../vendors/typeahead.js/typeahead.bundle.min.js"></script>
  <script src="../../vendors/select2/select2.min.js"></script>
  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script src="../../js/off-canvas.js"></script>
  <script src="../../js/hoverable-collapse.js"></script>
  <script src="../../js/template.js"></script>
  <script src="../../js/settings.js"></script>
  <script src="../../js/todolist.js"></script>
  <!-- endinject -->
  <!-- Custom js for this page-->
  <script src="../../js/file-upload.js"></script>
  <script src="../../js/typeahead.js"></script>
  <script src="../../js/select2.js"></script>
  <!-- End custom js for this page-->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</body>

</html>

<script>

    document.getElementById("CreditLimit").value = 0;

    // Only Text Input Validation
    function AlphabateValidate(inputElement) {
      let pattern = /^[a-zA-Z0-9!@#$%^&*()_+{}\[\]:;<>,.?~\\\-="'\s]+$/
      if (pattern.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid Name");
      }

      inputElement.addEventListener('blur', () => {
        if (!pattern.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }

    // Email Code  validation
    function emailValidate(inputElement) {
      let pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
      if (pattern.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid Email Address");
      }

      inputElement.addEventListener('blur', () => {
        if (!pattern.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }


    // ContantPersonName Code  validation
    function validateContactPersonName(inputElement) {
      let pattern = /^[a-zA-Z\s]+$/;
      if (pattern.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please enter a valid Contact Person Name (only alphabets and spaces are allowed).");
      }

      inputElement.addEventListener('blur', () => {
        if (!pattern.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }


    // Pin Code number validation
    function pinCodeValidate(inputElement) {
      if (inputElement.value.length > 6) {
        inputElement.value = inputElement.value.slice(0, 6);
      }

      if (/^[0-9]{6}$/.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid Pin Number");
      }

      inputElement.addEventListener('blur', () => {
        if (!/^[0-9]{6}$/.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }


    // aadhar number validation
    function aadharNumberValidate(inputElement) {
      if (inputElement.value.length > 12) {
        inputElement.value = inputElement.value.slice(0, 12);
      }

      if (/^[0-9]{12}$/.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid Pin Number");
      }

      inputElement.addEventListener('blur', () => {
        if (!/^[0-9]{12}$/.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }

    // contact number validation
    function contactNoValidate(inputElement) {
      inputElement.value = inputElement.value.replace(/\D/g, '');

      if (inputElement.value.length > 10) {
        inputElement.value = inputElement.value.slice(0, 10);
      }

      if (/^[9876]\d{9}$/.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid Contact Number");
      }

      inputElement.addEventListener('blur', () => {
        if (!/^[9876]\d{9}$/.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }




    // GST Code number validation
    function gstNoValidate(inputElement) {
      function convertToUpperCase() {
        inputElement.value = inputElement.value.toUpperCase();
      }
      convertToUpperCase();

      if (/^\d{2}[A-Z]{5}\d{4}[A-Z]\d[Z][A-Z\d]$/.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid GST Number");
      }

      inputElement.addEventListener('blur', () => {
        if (!/^\d{2}[A-Z]{5}\d{4}[A-Z]\d[Z][A-Z\d]$/.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }

    // PAN number validation
    function panNoValidate(inputElement) {
      inputElement.value = inputElement.value.toUpperCase();

      if (/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid PAN Number");
      }

      inputElement.addEventListener('blur', () => {
        if (!/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }

    // Credit Limit: number validation
    function CreditLimitValidate(inputElement) {
      let pattern = /^\d+(\.\d{1,2})?$/;

      if (pattern.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid Credit Limit");
      }

      inputElement.addEventListener('blur', () => {
        if (!pattern.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }


    // Credit Days: number validation
    function CreditDaysValidate(inputElement) {
      let pattern = /^[0-9]+$/;
      if (pattern.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid Number for Credit Days");
      }

      inputElement.addEventListener('blur', () => {
        if (!pattern.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }

    // Address validation
    function AddressValidate(inputElement) {
      let pattern = /^[a-zA-Z0-9!@#$%^&*()_+{}\[\]:;<>,.?~\\\-="'\s]+$/

      if (pattern.test(inputElement.value)) {
        inputElement.setCustomValidity('');
      } else {
        inputElement.setCustomValidity("Please Enter a Valid Address");
      }

      inputElement.addEventListener('blur', () => {
        if (!pattern.test(inputElement.value)) {
          inputElement.reportValidity();
        }
      });
    }

  </script>

   {{!-- Reference Number Generator --}}
  <script>
    $.get(`/customerMasterCode`, function (reffnum) {
      function generateUniqueIdentifier(response) {
        if (response && response.length === 1) {
          const item = response[0];
          const { id, prefix, lastNo, suffix } = item;

          // Increment the lastno value and pad it to 6 digits
          const newLastNo = (parseInt(lastNo) + 1).toString().padStart(6, '0');

          // Construct the unique identifier string
          const uniqueIdentifier = `${prefix}/${newLastNo}/${suffix}`;

          // Update the lastno value in the response
          item.lastNo = newLastNo;

          // Update the lastno value in the database
          /*  $.ajax({
              url: `/updateLastNo/${id}`, // Replace with the actual API endpoint for updating lastno
              method: 'POST',
              data: { lastNo: newLastNo },
              success: function(response) {
                console.log('Updated lastno in the database');
              },
              error: function(error) {
                console.error('Failed to update lastno in the database', error);
              }
            });*/
          // Update the input field value with the uniqueIdentifier
          $('#Code').val(uniqueIdentifier);


          return uniqueIdentifier;
        } else {
          return null; // Handle invalid response
        }
      }

      const uniqueIdentifier = generateUniqueIdentifier(reffnum);
      console.log('Generated Unique Identifier:', uniqueIdentifier);
    });
  </script>
  <script>

  // to convert the userinput to uppercase
  function convertToUpperCase(input) {
    input.value = input.value.toUpperCase();
  }



</script>