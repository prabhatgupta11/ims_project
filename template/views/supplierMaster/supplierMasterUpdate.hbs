<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Add Supplier</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="../../vendors/feather/feather.css">
  <link rel="stylesheet" href="../../vendors/ti-icons/css/themify-icons.css">
  <link rel="stylesheet" href="../../vendors/css/vendor.bundle.base.css">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <link rel="stylesheet" href="../../vendors/select2/select2.min.css">
  <link rel="stylesheet" href="../../vendors/select2-bootstrap-theme/select2-bootstrap.min.css">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="../../css/vertical-layout-light/style.css">
  <!-- endinject -->
  <link rel="shortcut icon" href="../../images/favicon.png" />
  <style>
    .color-container {
      position: absolute;
      z-index: 0;
      top: 0;
      height: 200px;
      width: 100%;
      background-color: #9096de;
    }
  </style>
</head>

<body>
  <div class="container-scroller">
    <!-- partial:../../partials/_navbar.html -->
    {{>navbar}}
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <!-- partial:../../partials/_settings-panel.html -->
      {{>setting}}
      <!-- partial -->
      <!-- partial:../../partials/_sidebar.html -->
      {{>side}}
      <!-- partial -->

      <div class="main-panel">
        <div class="color-container"></div>
        <div class="content-wrapper">

          <div class="row">
            <div class="d-flex mt-2 mb-3">
              <a href="/suppliersMasterList" class="text-white" style="z-index: 3;"><i class="fa-solid fa-angle-left "></i></a>
              <h3 class="card-title ml-4 my-0 font-weight-semibold text-white" style="z-index: 3;">Update Supplier</h3>
            </div>
            {{#if message}}
            <div class="alert alert-info">{{message}}</div>
            {{/if}}
            <div id="flash-message" class="alert alert-danger" style="display: none;"></div>
      <form id="supplierForm" action="/supplierMasterUpdate/{{supplier.rowguid}}" method="post">
              <div class="row justify-content-around m-1">
                <div class="col-md-6 grid-margin stretch-card">
                  <div class="card  col-md-11 wrapper">
                    <div class="card-body p-0">
                      <div class="row justify-content-around mx-auto ">
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="exampleFormControlTextarea1" class="mt-2 mr-3">Name<span
                                class="text-danger">*</span></label>
                            <input class="form-control input-field" ttype="text" id="Name" name="Name"
                              value="{{supplier.Name}}" placeholder="&#128100; Enter Supplier Name"
                              oninput="AlphabateValidate(this)" required title="Please enter only letters">
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="exampleFormControlTextarea1" class="mt-2 mr-3">Contact Person Name</label>
                            <input class="form-control input-field" type="text" id="ContactPersonName"
                              name="ContactPersonName" value="{{supplier.ContactPersonName}}"
                              oninput="validateContactPersonName(this)" placeholder="&#128100; Enter Contact Person"
                              pattern="[A-Za-z ]+" title="Please enter only letters">
                          </div>
                        </div>
                      </div>
                      <div class="row justify-content-around mx-auto ">
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="exampleFormControlTextarea1" class="mt-2 mr-3">Contact No.<span
                                class="text-danger">*</span></label>
                            <input class="form-control input-field" type="number" id="ContactNo" name="ContactNo"
                              value="{{supplier.ContactNo}}" placeholder="&#x260E; Enter Contact Number" required
                              maxlength="20" title="Please enter a 10-digit phone number"
                              oninput="contactNoValidate(this)">
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Email">Email <span class="text-danger">*</span> :</label>
                            <input class="form-control input-field" type="email" id="Email" name="Email"
                              value="{{supplier.Email}}" placeholder="&#x2709;  Enter Email"
                              oninput="emailValidate(this)" required />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="AadharNo">Aadhar No</label>
                            <input class="form-control input-field" type="number" id="AadharNo" name="AadharNo"
                              value="{{supplier.AadharNo}}" placeholder="&#9751;  Enter Aadhar Number"
                              title="Please enter a 12-digit Aadhar Number" maxlength="12"
                              oninput="aadharNumberValidate(this)">
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">

                            <label for="PAN">PAN <span class="text-danger">*</span></label>
                            <input class="form-control input-field" type="text" id="PAN" name="PAN"
                              value="{{supplier.PAN}}" placeholder="&#9751; Enter PAN" oninput="panNoValidate(this)"
                              minlength="10" maxlength="10" title="Please enter a 10-digit PAN Number" required />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Address">Address <span class="text-danger">*</span></label>
                            <div>
                              <textarea class="form-control input-field" id="Address" name="Address"
                                 rows="4" placeholder="Enter Address" cols="72"
                                style="width: 100%;" oninput="AddressValidate(this)" required>{{supplier.Address}}</textarea><br><br>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-6 grid-margin stretch-card ">
                  <div class="card  col-md-11 wrapper">
                    <div class="card-body p-0">
                      <div class="row justify-content-around mx-auto ">
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="store">Store <span class="text-danger">*</span></label>
                            <select class="form-control input-field" name="outletId" id="store" required>
                              {{!-- <option value="" disabled selected> Select Store</option> --}}
                              <option value="{{previousStore.outletId}}"> {{previousStore.storeName}}</option>
                              {{#each store}}
                              <option value='{{outletId}}'>{{storeName}}</option>
                              {{/each}}
                            </select>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Code" class="label-block">Code</label>
                            <input class="form-control input-field" type="text" id="Code" name="Code"
                              value="{{supplier.Code}}" class="sup-int" placeholder="Enter Supplier Code" />
                            <div class="sup-icon">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="Pincode">Pincode</label>
                            <input class="form-control input-field" type="number" id="Pincode" name="Pincode"
                              value="{{supplier.Pincode}}" placeholder=" Enter Pincode" maxlength="6"
                              title="Please enter a 6-digit Pin Code Number" oninput="pinCodeValidate(this)" />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="GSTNo">GST No <span class="text-danger">*</span></label>
                            <input class="form-control input-field" type="text" id="GSTNo" name="GSTNo"
                              value="{{supplier.GSTNo}}" placeholder="Enter GST No." oninput="gstNoValidate(this)"
                              minlength="15" maxlength="15" title="Please enter a 15-digit GST Number" required />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="CreditLimit">Credit Limit:</label>
                            <input class="form-control input-field" type="number" id="CreditLimit" name="CreditLimit"
                              value="{{supplier.CreditLimit}}" placeholder="Enter Credit Limit"
                              oninput="CreditLimitValidate(this)" />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">
                            <label for="CreditDays">Credit Days:</label>
                            <input class="form-control input-field" type="number" id="CreditDays" name="CreditDays"
                              value="{{supplier.CreditDays}}" placeholder="Enter Credit Days" />
                          </div>
                        </div>
                        <div class="col-md-12">
                          <div class="form-group mb-2 ">

                            <label for="Status" class="label-block">Status:</label>
                            <select class="form-control input-field" id="Status" name="Status">
                              <option value="{{supplier.Status}}">{{supplier.Status}}</option>

                            </select>
                          </div>
                        </div>
                         <div class="inner-cont p-0 col-md-11 col-lg-11 flex-column  flex-wrap col-12 d-flex  justify-content-between align-content-start">
                         <div class="d-flex align-items-center justify-content-start my-2  col-md-12 p-0" >
                         <button class="btn btn-primary mr-2 " role="button" type="submit" style="padding: 9px 20px;
    border-radius: 6px;">Save</button>
                    <button class="btn btn-light" role="button" type="reset" style=" padding: 9px 20px;
    border-radius: 6px;">Reset</button>
    </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>


            </form>
          </div>

        </div>


      </div>
    </div>
  </div>
  <!-- container-scroller -->
  <!-- plugins:js -->
  <script src="../../vendors/js/vendor.bundle.base.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script src="../../vendors/typeahead.js/typeahead.bundle.min.js"></script>
  <script src="../../vendors/select2/select2.min.js"></script>
  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script src="../../js/off-canvas.js"></script>
  <script src="../../js/hoverable-collapse.js"></script>
  <script src="../../js/template.js"></script>
  <script src="../../js/settings.js"></script>
  <script src="../../js/todolist.js"></script>
  <!-- endinject -->
  <!-- Custom js for this page-->
  <script src="../../js/file-upload.js"></script>
  <script src="../../js/typeahead.js"></script>
  <script src="../../js/select2.js"></script>
  <!-- End custom js for this page-->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</body>

</html>

{{!-- Reference Number Generator --}}
  <script>
    $.get(`/supplierMasterCode`, function (reffnum) {
      function generateUniqueIdentifier(response) {
        if (response && response.length === 1) {
          const item = response[0];
          const { id, prefix, lastNo, suffix } = item;

          // Increment the lastno value and pad it to 6 digits
          const newLastNo = (parseInt(lastNo) + 1).toString().padStart(6, '0');

          // Construct the unique identifier string
          const uniqueIdentifier = `${prefix}/${newLastNo}/${suffix}`;

          // Update the lastno value in the response
          item.lastNo = newLastNo;


          // Update the input field value with the uniqueIdentifier
          $('#Code').val(uniqueIdentifier);


          return uniqueIdentifier;
        } else {
          return null; // Handle invalid response
        }
      }

      const uniqueIdentifier = generateUniqueIdentifier(reffnum);
      console.log('Generated Unique Identifier:', uniqueIdentifier);
    });
  </script>

<script>

  document.getElementById("CreditLimit").value = 0;

  // Only Text Input Validation
  function AlphabateValidate(inputElement) {
    let pattern = /^[a-zA-Z0-9!@#$%^&*()_+{}\[\]:;<>,.?~\\\-="'\s]+$/
    if (pattern.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid Name");
    }

    inputElement.addEventListener('blur', () => {
      if (!pattern.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }

  // Email Code  validation
  function emailValidate(inputElement) {
    let pattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
    if (pattern.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid Email Address");
    }

    inputElement.addEventListener('blur', () => {
      if (!pattern.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }


  // ContantPersonName Code  validation
  function validateContactPersonName(inputElement) {
    let pattern = /^[a-zA-Z\s]+$/;
    if (pattern.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please enter a valid Contact Person Name (only alphabets and spaces are allowed).");
    }

    inputElement.addEventListener('blur', () => {
      if (!pattern.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }


  // Pin Code number validation
  function pinCodeValidate(inputElement) {
    if (inputElement.value.length > 6) {
      inputElement.value = inputElement.value.slice(0, 6);
    }

    if (/^[0-9]{6}$/.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid Pin Number");
    }

    inputElement.addEventListener('blur', () => {
      if (!/^[0-9]{6}$/.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }


  // aadhar number validation
  function aadharNumberValidate(inputElement) {
    if (inputElement.value.length > 12) {
      inputElement.value = inputElement.value.slice(0, 12);
    }

    if (/^[0-9]{12}$/.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid Pin Number");
    }

    inputElement.addEventListener('blur', () => {
      if (!/^[0-9]{12}$/.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }

  // contact number validation
  function contactNoValidate(inputElement) {
    inputElement.value = inputElement.value.replace(/\D/g, '');

    if (inputElement.value.length > 10) {
      inputElement.value = inputElement.value.slice(0, 10);
    }

    if (/^[9876]\d{9}$/.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid Contact Number");
    }

    inputElement.addEventListener('blur', () => {
      if (!/^[9876]\d{9}$/.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }

  // Convert into upper case
  {
    {
      !-- function convertToUpperCase(input) {
        input.value = input.value.toUpperCase();
      } --}
  }


  // GST Code number validation
  function gstNoValidate(inputElement) {
    function convertToUpperCase() {
      inputElement.value = inputElement.value.toUpperCase();
    }
    convertToUpperCase();

    if (/^\d{2}[A-Z]{5}\d{4}[A-Z]\d[Z][A-Z\d]$/.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid GST Number");
    }

    inputElement.addEventListener('blur', () => {
      if (!/^\d{2}[A-Z]{5}\d{4}[A-Z]\d[Z][A-Z\d]$/.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }

  // PAN number validation
  function panNoValidate(inputElement) {
    inputElement.value = inputElement.value.toUpperCase();

    if (/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid PAN Number");
    }

    inputElement.addEventListener('blur', () => {
      if (!/^[A-Z]{5}[0-9]{4}[A-Z]$/.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }

  // Credit Limit: number validation
  function CreditLimitValidate(inputElement) {
    let pattern = /^\d+(\.\d{1,2})?$/;

    if (pattern.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid Credit Limit");
    }

    inputElement.addEventListener('blur', () => {
      if (!pattern.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }


  // Credit Days: number validation
  function CreditDaysValidate(inputElement) {
    let pattern = /^[0-9]+$/;
    if (pattern.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid Number for Credit Days");
    }

    inputElement.addEventListener('blur', () => {
      if (!pattern.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }

  // Address validation
  function AddressValidate(inputElement) {
    let pattern = /^[a-zA-Z0-9!@#$%^&*()_+{}\[\]:;<>,.?~\\\-="'\s]+$/

    if (pattern.test(inputElement.value)) {
      inputElement.setCustomValidity('');
    } else {
      inputElement.setCustomValidity("Please Enter a Valid Address");
    }

    inputElement.addEventListener('blur', () => {
      if (!pattern.test(inputElement.value)) {
        inputElement.reportValidity();
      }
    });
  }

</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const statusSelect = document.getElementById("Status");

    let statusArray = ["Active", "Inactive"]

    statusArray.forEach((ele) => {
      const option = document.createElement("option");
      if (statusSelect.value !== ele) {
        option.value = ele;
        option.textContent = ele;
        statusSelect.appendChild(option);
      }
    })
  })


  function setDefaultCreditLimit(inputElement) {
    if (inputElement.value.trim() === "") {
      inputElement.value = "0";
    }
  }
</script>