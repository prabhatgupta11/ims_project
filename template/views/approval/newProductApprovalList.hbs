<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Approval</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="/vendors/feather/feather.css">
    <link rel="stylesheet" href="../../vendors/ti-icons/css/themify-icons.css">
    <link rel="stylesheet" href="../../vendors/css/vendor.bundle.base.css">
    <!-- endinject -->
    <!-- Plugin css for this page -->
    <link rel="stylesheet" href="../../vendors/select2/select2.min.css">
    <link rel="stylesheet" href="../../vendors/select2-bootstrap-theme/select2-bootstrap.min.css">
    <!-- End plugin css for this page -->
    <!-- inject:css -->
    <link rel="stylesheet" href="../../css/vertical-layout-light/style.css">
    <!-- endinject -->
    <link rel="shortcut icon" href="../../images/favicon.png" />
    <link rel="stylesheet" href="css/newStyle.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.20/dist/sweetalert2.min.css">
    <style>
        /* Light color for even rows */
        .table-custom tbody tr:nth-child(even) {
            background-color: #ffff;
        }

        /* Dark color for odd rows */
        .table-custom tbody tr:nth-child(odd) {
            background-color: rgb(244, 244, 247);
        }

        .breadcrumdiv {
            margin-left: 4px;


        }



        #line {
            padding-bottom: 5px;
            padding-right: 10px;
            padding-left: 12px;
            height: 40px;
            /* Set the height of the container div */

            display: flex;
            align-items: center;
            /* Vertically center the content */
            justify-content: center;
            /* Horizontally center the content */
        }

        #line-content {
            /* font-size: 24px; /* Adjust the font size for the content */
            /*  font-weight: 0px;  /* Adjust the font weight for a thinner appearance */
            background-color: #cbd5e1;
            width: 1px;
            height: 70%;
        }


        form.over {
            overflow-x: scroll;
            overflow-y: scroll;
        }



        form.over {
            overflow: hidden;
        }

        @media (max-width: 768px) {

            form.over {
                overflow-x: scroll;
                overflow-y: scroll;
            }


        }

        @media (max-width: 1024px) {

            form.over {
                overflow-x: scroll;
                overflow-y: scroll;
            }

        }

        @media (max-width: 820px) {

            form.over {
                overflow-x: scroll;
                overflow-y: scroll;
            }


        }








        .fa-solid.fa-list {
            margin-right: 4px;
            width: 40px;
            height: 35px;
            position: relative;
            bottom: 3px;
        }


        @media (min-width:300px) and (max-width:400px) {
            .dataTables_length {
                margin-right: 157px !important;
                margin-bottom: 10px;
            }
        }

        @media (min-width:401px) and (max-width:500px) {
            .dataTables_length {
                margin-right: 157px !important;
                margin-bottom: 10px;
            }
        }

        .button-2>a {
            color: #333333;
        }

        .button-30 {
            align-items: center;
            appearance: none;
            background-color: #FCFCFD;
            border-radius: 4px;
            border-width: 0;
            box-shadow: rgba(45, 35, 66, 0.4) 0 2px 4px, rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #D6D6E7 0 -3px 0 inset;
            box-sizing: border-box;
            color: #36395A;
            cursor: pointer;
            display: inline-flex;
            font-size: 13px;
            padding: 10px;
            justify-content: center;
            line-height: 1;
            list-style: none;
            overflow: hidden;
            position: relative;
            text-align: left;
            text-decoration: none;
            transition: box-shadow .15s, transform .15s;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
            white-space: nowrap;
            will-change: box-shadow, transform;

        }

        .button-30:focus {
            box-shadow: #D6D6E7 0 0 0 1.5px inset, rgba(45, 35, 66, 0.4) 0 2px 4px, rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #D6D6E7 0 -3px 0 inset;
        }

        .button-30:hover {
            box-shadow: rgba(45, 35, 66, 0.4) 0 4px 8px, rgba(45, 35, 66, 0.3) 0 7px 13px -3px, #D6D6E7 0 -3px 0 inset;
            transform: translateY(-2px);
        }

        .button-30:active {
            box-shadow: #D6D6E7 0 3px 7px inset;
            transform: translateY(2px);
        }

        .color-container {
            position: absolute;
            z-index: 0;
            top: 0;
            height: 200px;
            width: 100%;
            background-color: #9096de;
        }
    </style>
</head>

<body id="body-pd">

    <!-- partial:../../partials/_navbar.html -->
    {{>navbar}}
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
        <!-- partial:../../partials/_settings-panel.html -->
        {{>setting}}
        <!-- partial -->
        <!-- partial:../../partials/_sidebar.html -->
        {{>side}}
        <!-- partial -->

        <div class="soon w-100">


            <div class="color-container"></div>
            <div class="col-md-12 row-md-5 mx-0 main_container ">
                <div class="row-md-4 subtitle d-flex justify-content-between align-items-center mb-3">
                    <div class="d-flex ">


                    </div>

                    <div class="w-100 d-flex justify-content-between align-items-center mb-2 mt-4">
                        <h3 class="card-title my-0 font-weight-semibold text-white ls-tighter" style="z-index: 3;"> <i
                                class="fa-solid fa-address-book mr-2"></i>Product Approval List</h3>
                    </div>

                </div>


                <div class="container col-md-12 me-class" style="padding-right:24px; border-radius: 10px;">
                
                    <div class="shub-class">
                        <label for="store">Approval Status</label>
                        <div class="cons" style="position: relative;">
                            <div class="icon-context input-field" style="position: absolute; top:2px;left:10px ">
                                <i class="fa-solid fa-store icons-icons mt-1" style="font-size: 15px;color: #c5c5c5;margin-top: 7px;"></i>
                            </div>
                            <select name="approvalStatus" id="approvalStatus" class="form-control store-select w-25 py-1 rounded-3"
                                style="padding-left: 30px;font-size:14px">
                                {{!-- <option value="">Select Status</option> --}}
                                <option value="pending">Pending</option>
                                <option value="approved">Approved</option>
                                <option value="rejected">Rejected</option>
                            </select>
                        </div>
                    </div>

                    <div class="container-table pt-2 p-0 mt-4 table-responsive">
                        <form class="over">
                    <table class="table table-custom" id="product_table">
                                <thead>
                                    <tr>
                                        <th scope="col ">Product Name</th>
                                        <th scope="col ">Status </th>
                                        <th scope="col ">Select</th>
                                        <th scope="col ">Action</th>
                                    </tr>
                                </thead>
                                <tbody>

                                </tbody>



                            </table>
                        </form>
                    </div>
                </div>

            </div>
        </div>

        <!-- container-scroller -->
        <!-- plugins:js -->
        <script src="../../vendors/js/vendor.bundle.base.js"></script>
        <!-- endinject -->
        <!-- Plugin js for this page -->
        <script src="../../vendors/typeahead.js/typeahead.bundle.min.js"></script>
        <script src="../../vendors/select2/select2.min.js"></script>
        <!-- End plugin js for this page -->
        <!-- inject:js -->
        <script src="../../js/off-canvas.js"></script>
        <script src="../../js/hoverable-collapse.js"></script>
        <script src="../../js/template.js"></script>
        <script src="../../js/settings.js"></script>
        <script src="../../js/todolist.js"></script>
        <!-- endinject -->
        <!-- Custom js for this page-->
        <script src="../../js/file-upload.js"></script>
        <script src="../../js/typeahead.js"></script>
        <script src="../../js/select2.js"></script>

        <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
        <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>

        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">


        {{!--
        <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
        <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
        <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap4.min.js"></script>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css"></script>
        <script src="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap4.min.css"></script> --}}

        <script>
            $(document).ready(function () {
                const dataTable = $('#product_table').DataTable({
                    "language": {
                        "lengthMenu": "Show _MENU_ Entries"
                    },
                    'processing': true,
                    'serverSide': true,
                    'ajax': {
                        'url': 'updateNewProductApprovalStatus',  // Change to the appropriate server-side route
                        'type': 'POST',  // Change to POST request
                        'data': function (d) {
                            // Send the selected outletId to the server
                            d.approvalStatus = $('#approvalStatus').val();
                        }
                    },
                    'columns': [
                        { data: 'itemName' },
                        { data: 'status' },
                        {
                            data: 'rowguid',
                            render: function (data, type, row) {
                                if (row.status === 'approved' || row.status === 'rejected') {
                                    return ''; // Hide the checkboxes for approved or rejected status
                                }
                                // Create a checkbox input for each row
                                return '<input type="checkbox" name="selectedProducts" value="' + data + '">';
                            }
                        },
                        {
                            data: 'status',
                            render: function (data, type, full, meta) {
                                if (data === 'pending') {
                                    return '<button class="btn btn-success approve-btn" style="padding: 8px 12px;margin-right: 5px;">Approve</button>' +
                                        '<button class="btn btn-danger reject-btn" style="padding: 8px 12px;">Reject</button>';
                                } else if (data === 'approved') {
                                    return '<button class="btn btn-success" type="button" style="padding: 8px 12px;"  disable>Approved</button>';
                                } else if (data === 'rejected') {
                                    return '<button class="btn btn-danger" type="button" style="padding: 8px 12px;"  disable>Rejected</button>';
                                }
                            }
                        }

                    ],
                });

                // // Update the DataTable when the store selection changes
                $('#approvalStatus').on('change', function () {
                    dataTable.ajax.reload();
                });
            });



            // Handle the "Approve" button click
            $('#product_table').on('click', '.approve-btn', function () {
                // Get the selected product names
                const selectedProducts = [];
                const checkboxes = $('#product_table input[name="selectedProducts"]:checked');
                checkboxes.each(function () {
                    selectedProducts.push($(this).val());
                });
                console.log(123456, selectedProducts)
                // Hide the "Approve" button for the selected items
                checkboxes.each(function () {
                    $(this).closest('tr').find('.approve-btn').hide();
                });

                // You will need to implement this part on the server-side
                $.post('updateApprovalStatusOfProduct', { products: selectedProducts, action: 'approved' }, function (response) {
                    // Check if the selected items are approved
                    console.log(response)
                    if (response) {
                        // Hide the "Approve" button for the selected items
                        checkboxes.each(function () {
                            $(this).closest('tr').find('.approve-btn').hide();
                        });
                    }
                });
            });



            // Handle the "Reject" button click
            $('#product_table').on('click', '.reject-btn', function () {
                // Get the selected product names
                const selectedProducts = [];
                const checkboxes = $('#product_table input[name="selectedProducts"]:checked');
                checkboxes.each(function () {
                    selectedProducts.push($(this).val());
                });

                // Hide the "Approve" button for the selected items
                checkboxes.each(function () {
                    $(this).closest('tr').find('.reject-btn').hide();
                });
                // Send a request to update the selected products to "Rejected"
                // You will need to implement this part on the server-side
                $.post('updateApprovalStatusOfProduct', { products: selectedProducts, action: 'rejected' }, function (response) {
                    // Check if the selected items are approved
                    console.log(response)
                    if (response) {
                        // Hide the "Approve" button for the selected items
                        checkboxes.each(function () {
                            $(this).closest('tr').find('.reject-btn').hide();
                        });
                    }
                });
            });

        </script>


</body>

</html>